<!-- views/account/favorites.ejs -->
  <h1>My Favorites</h1>
  <% if (vehicles && vehicles.length > 0) { %>
    <ul id="inv-display">
      <% vehicles.forEach(vehicle => { %>
        <li class="vehicle-card">
          <a href="/inv/detail/<%= vehicle.inv_id %>">
            <img src="<%= vehicle.inv_thumbnail %>" alt="<%= vehicle.inv_make %> <%= vehicle.inv_model %>">
          </a>
          <div class="namePrice">
            <h2><a href="/inv/detail/<%= vehicle.inv_id %>"><%= vehicle.inv_make %> <%= vehicle.inv_model %></a></h2>
            <span><%= new Intl.NumberFormat('en-US').format(vehicle.inv_price) %></span>
            <form class="fav-form" data-inv="<%= vehicle.inv_id %>">
              <button type="button" class="remove-fav-btn" data-inv="<%= vehicle.inv_id %>">Remove</button>
            </form>
          </div>
        </li>
      <% }) %>
    </ul>
  <% } else { %>
    <p class="notice">You don't have any favorites yet.</p>
  <% } %>
<script>
document.addEventListener('click', async (e) => {
  if (e.target.matches('.remove-fav-btn')) {
    const invId = e.target.dataset.inv;
    const res = await fetch('/account/favorites/remove', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ inv_id: invId })
    });
    if (res.ok) window.location.reload();
    else alert('Failed to remove favorite.');
  }
});
</script>
